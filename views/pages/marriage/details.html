{% extends "details-template.njk" %}

{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "hmpo-submit/macro.njk" import hmpoSubmit %}
{% from "components/lev-flag.njk" import levFlag %}

{% set hmpoPageKey = "marriage.detailsPage" %}
{% set govukServiceNameKey = translate("pages.marriage.serviceName") %}
{% set govukServiceTitleKey = translate("pages.marriage.detailPage.pageTitle") %}
{% set govukServiceUrl = "/marriage" %}

{% set hasRecord = record and record.length > 0 %}

{% if hasRecord %}
    {% set hmpoTitle = title %}
{% else %}
    {% set hmpoTitle = "User Organisation does not have permission to access records" %}
{% endif %}

{% block mainContent %}
    {{ super() }}
    {% if hasRecord %}
        {% if record.flags.refer %}
            {{ levFlag(ctx, {key: "refer", type: "alert"}) }}
        {% endif %}

        {% include "../links.html" %}

        {{ govukTable({
            classes: "details",
            firstCellIsHeader: true,
            rows: record
        }) }}
    {% endif %}

    <div class="govuk-button-group">
        {{ hmpoSubmit(ctx, {id: "newSearch", key: "newSearch", href: "/marriage"}) }}
        {{ hmpoSubmit(ctx, {id: "editSearch", key: "editSearch", href: "/marriage/search", classes: "blue"}) }}
        {% if showBackToResults %}
            {{ hmpoSubmit(ctx, {
                id: "backToResults",
                key: "backToResults",
                href: "/marriage/results",
                classes: "grey"
            }) }}
        {% endif %}
    </div>
{% endblock %}
