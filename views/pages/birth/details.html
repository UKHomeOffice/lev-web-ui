{% extends "details-template.njk" %}

{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "hmpo-submit/macro.njk" import hmpoSubmit %}
{% from "components/lev-flag.njk" import levFlag %}

{% set hmpoPageKey = "birth.detailsPage" %}
{% set govukServiceNameKey = translate("pages.birth.serviceName") %}
{% set govukServiceTitleKey = translate("pages.birth.detailPage.pageTitle") %}
{% set govukServiceUrl = "/birth" %}

{% set hasRecord = record and record.length > 0 %}

{% if hasRecord %}
    {% set hmpoTitle = title %}
{% else %}

    {#  need to look at this - potentially an error state #}
    {% set hmpoTitle = "Sorry, there is a problem with the service" %}
    <p>Search results are currently not available to members of your organisation.</p>
    <p>Try again later. If the issue persists, contact an administrator.</p>
{% endif %}

{% block mainContent %}
    {{ super() }}

    {% if hasRecord %}
        {% include "./flags.html" %}
        {% include "../links.html" %}

        {{ govukTable({
            classes: "details",
            firstCellIsHeader: true,
            rows: record
        }) }}
    {% endif %}

    <div class="govuk-button-group">
        {{ hmpoSubmit(ctx, {id: "newSearch", key: "newSearch", href: "/birth"}) }}
        {{ hmpoSubmit(ctx, {id: "editSearch", key: "editSearch", href: "/birth/search", classes: "blue"}) }}
        {% if showBackToResults %}
            {{ hmpoSubmit(ctx, {
                id: "backToResults",
                key: "backToResults",
                href: "/birth/results",
                classes: "grey"
            }) }}
        {% endif %}
    </div>
{% endblock %}
